{#
  Tags index page.

  Frequency-sorted tags with usage counts, grouped by frequency
  bands for scannability. Only tags with 2+ uses are included.
  Rare section (2-4 uses) is capped at 30 items.

  Context:
    tags: list of dicts (sorted by count descending):
      - name: str
      - count: int
#}
# Tags

{{ tags | length }} tags

---
{% if tags %}
{% set ns = namespace(band='', rare_count=0) %}
{% for tag in tags %}
{% if tag.count >= 20 and ns.band != 'frequent' %}
{% set ns.band = 'frequent' %}

## Frequent (20+)
{% elif tag.count >= 10 and tag.count < 20 and ns.band != 'common' %}
{% set ns.band = 'common' %}

## Common (10â€“19)
{% elif tag.count >= 5 and tag.count < 10 and ns.band != 'occasional' %}
{% set ns.band = 'occasional' %}

## Occasional (5â€“9)
{% elif tag.count < 5 and ns.band != 'rare' %}
{% set ns.band = 'rare' %}

## Rare (2â€“4)
{% endif %}
{% if ns.band == 'rare' %}
{% set ns.rare_count = ns.rare_count + 1 %}
{% if ns.rare_count <= 30 %}
- {{ tag.name | wikilink }}
  {{ tag.count }}
{% elif ns.rare_count == 31 %}
*...and {{ tags | selectattr("count", "lt", 5) | list | length - 30 }} more*
{% endif %}
{% else %}
- {{ tag.name | wikilink }}
  {{ tag.count }}
{% endif %}
{% endfor %}
{% endif %}
