{% from "macros/thread_display.jinja2" import render_thread %}
{% from "macros/entry_listing.jinja2" import render_entries %}
# {{ display_name }}
{% if aliases %}

*Also known as: {{ aliases | mid_dot_join }}*
{% endif %}
{% if relation %}

**Relation:** {{ relation }}{% if tier == "narrator" %} | **Narrator**{% endif %}
{% endif %}
{% if tier == "narrator" %}

[Edit metadata]({{ "person_yaml" | source_path(slug) }})

*Appears in all entries.* [Browse entries](/indexes/entry-index)
{% elif tier == "frequent" %}

[Edit metadata]({{ "person_yaml" | source_path(slug) }})

{{ entry_count }} entr{{ "y" if entry_count == 1 else "ies" }}{% if date_range %} Â· {{ date_range }}{% endif %}
{% else %}

[Edit metadata]({{ "person_yaml" | source_path(slug) }})

{{ entry_count }} entr{{ "y" if entry_count == 1 else "ies" }}
{% endif %}

---
{% if tier == "narrator" %}
{% if top_companions %}

## Top Companions
{% for group in top_companions %}

{% if group.relation %}
**{{ group.relation }}:**
{% endif %}
{% for companion in group.companions %}
- {{ companion.name | wikilink }} ({{ companion.count }})
{% endfor %}
{% endfor %}
{% endif %}
{% if top_places %}

## Top Places
{% for city in top_places %}

### {{ city.name | wikilink }}
{% if city.neighborhoods %}
{% for nb in city.neighborhoods %}

**{{ nb.name }}**
{% for loc in nb.locations %}
- {{ loc.name | wikilink }} ({{ loc.count }})
{% endfor %}
{% endfor %}
{% else %}
{% for loc in city.locations %}
- {{ loc.name | wikilink }} ({{ loc.count }})
{% endfor %}
{% endif %}
{% endfor %}
{% endif %}
{% elif tier == "frequent" %}

[All entries ({{ entry_count }})]({{ slug }}-entries)
{% if places %}

---

## Places
{% for city in places[:5] %}

### {{ city.name | wikilink }}
{% if city.neighborhoods %}
{% for nb in city.neighborhoods %}

**{{ nb.name }}**
{% for loc in nb.locations %}
- {{ loc.name | wikilink }} ({{ loc.count }})
{% endfor %}
{% endfor %}
{% else %}
{% for loc in city.locations %}
- {{ loc.name | wikilink }} ({{ loc.count }})
{% endfor %}
{% endif %}
{% endfor %}
{% endif %}
{% if companions %}

---

## Companions
{% for companion in companions[:10] %}
- {{ companion.name | wikilink }} ({{ companion.count }} shared)
{% endfor %}
{% endif %}
{% elif tier == "infrequent" %}
{% if entries %}

## Entries

{{ render_entries(entries) }}
{% endif %}
{% if places %}

---

## Places
{% for city in places %}

### {{ city.name | wikilink }}
{% for loc in city.locations %}
- {{ loc | wikilink }}
{% endfor %}
{% endfor %}
{% endif %}
{% endif %}
{% if characters %}

---

## Characters
{% for character in characters %}
- {{ character.name | wikilink }}
{% if character.contribution %}  *{{ character.contribution }}*{% endif %}
{% endfor %}
{% endif %}
